#!/usr/bin/env node

// Simple wrapper that preserves the current working directory
const path = require('path');

// Find the project root (where package.json is) but don't change to it
const projectRoot = __dirname;

// Store the original working directory
const originalCwd = process.cwd();

// Temporarily add the project root to module paths so requires work
const Module = require('module');
const originalResolveFilename = Module._resolveFilename;
Module._resolveFilename = function(request, parent, isMain) {
  // For relative requires starting with './', use the project root
  if (request.startsWith('./') && parent && parent.filename === __filename) {
    request = path.resolve(projectRoot, request.substring(2));
  }
  return originalResolveFilename.call(this, request, parent, isMain);
};

// Import and run the main CLI without changing directories
require('./bin/bvc.js');
